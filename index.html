<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OuassVTC - R√©servez votre chauffeur priv√© √† Perpignan</title>
  <meta name="description" content="VTC √† Perpignan - Chauffeur priv√© 24/7. R√©servation simple avec estimation tarifaire instantan√©e. Service rapide, s√©curis√© et ponctuel." />
  <meta name="keywords" content="VTC Perpignan, chauffeur priv√©, taxi Perpignan, Uber Perpignan, Bolt Perpignan, transport a√©roport, r√©servation VTC" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {font-family:'Segoe UI',sans-serif;margin:0;padding:0;background:#f0f2f5;color:#333;}
    header,footer{background-color:#000;color:white;text-align:center;padding:20px 10px;}
    header img{max-height:100px;}
    nav{background:#111;padding:10px 0;text-align:center;}
    nav a{color:white;margin:0 15px;text-decoration:none;font-weight:500;}
    .container{max-width:960px;margin:auto;padding:20px;}
    .hero-text{text-align:center;margin:30px 0;}
    .buttons{display:flex;flex-wrap:wrap;justify-content:center;gap:15px;margin:20px 0;}
    .buttons a{background:#007bff;color:white;padding:12px 20px;border-radius:8px;text-decoration:none;font-weight:500;}
    form{background:#fff;padding:25px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1);}
    input,textarea,select,button{width:100%;padding:12px;margin:10px 0;border-radius:6px;border:1px solid #ccc;font-size:16px;}
    button{background-color:#007bff;color:white;font-weight:bold;border:none;cursor:pointer;transition:0.3s;}
    button.green{background-color:#28a745;}
    button:hover{opacity:0.9;}
    .confirmation{text-align:center;margin-top:20px;color:green;font-weight:bold;}
    #map{height:300px;margin-top:20px;border-radius:10px;}
    #google_translate_element{text-align:center;margin-top:30px;}
    .cookie-banner{position:fixed;bottom:0;left:0;right:0;background:#222;color:white;text-align:center;padding:10px;font-size:14px;}
    .cookie-banner button{background:#007bff;color:white;border:none;padding:5px 10px;margin-left:10px;cursor:pointer;border-radius:4px;}
  </style>

  <!-- ‚úÖ Google Analytics 4 avec suivi des conversions -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-23LLHRH2QL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-23LLHRH2QL');

    // ‚úÖ D√©claration des conversions importantes
    function trackConversion(eventName){
      gtag('event', eventName, {
        'event_category': 'Conversion',
        'event_label': eventName,
        'value': 1
      });
    }
  </script>
</head>
<body>
  <nav>
    <a href="services.html" onclick="trackConversion('click_services')">Services</a>
    <a href="faq.html" onclick="trackConversion('click_faq')">FAQ</a>
    <a href="qui-sommes-nous.html" onclick="trackConversion('click_about')">Qui sommes-nous</a>
    <a href="contact.html" onclick="trackConversion('click_contact')">Contact</a>
  </nav>

  <header>
    <img src="ouassvtc.png" alt="Logo OuassVTC" />
  </header>

  <div class="container">
    <div class="hero-text">
      <h2>Votre chauffeur VTC priv√© √† Perpignan</h2>
      <p>R√©servez votre trajet simplement avec estimation instantan√©e. Confort, s√©curit√© et ponctualit√© garanties.</p>
    </div>

    <div class="buttons">
      <a href="tel:0644120784" onclick="trackConversion('call_click')">üìû Appeler</a>
      <a href="https://wa.me/33644120784" target="_blank" onclick="trackConversion('whatsapp_click')">üí¨ WhatsApp</a>
      <a href="sms:+33644120784" onclick="trackConversion('sms_click')">‚úâÔ∏è SMS</a>
    </div>

    <div class="form-section">
      <form onsubmit="sendEmail(event)">
        <input type="text" id="nom" placeholder="Nom" required />
        <input type="tel" id="telephone" placeholder="T√©l√©phone" required />
        <input type="text" id="depart" placeholder="Adresse de d√©part" required />
        <input type="text" id="arrivee" placeholder="Adresse d'arriv√©e" required />
        <label for="dateheure">Date de la r√©servation</label>
        <input type="datetime-local" id="dateheure" name="dateheure" required />
        <select id="passagers" required>
          <option value="">Nombre de passagers</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        <textarea id="message" placeholder="Informations compl√©mentaires..."></textarea>
        <div id="prixEstime" class="confirmation">Distance : -- km | Estimation : -- ‚Ç¨</div>
        <button type="button" class="green" onclick="calculerEstimation(); trackConversion('estimate_click')">Estimer le tarif</button>
        <button type="submit">Envoyer la demande</button>
      </form>
    </div>

    <div id="map"></div>
    <div id="google_translate_element"></div>
  </div>

  <footer>
    ¬© 2025 OuassVTC - Tous droits r√©serv√©s. Contact : contact@ouassvtc.fr
  </footer>

  <!-- ‚úÖ Bandeau Cookie -->
  <div class="cookie-banner" id="cookie-banner">
    Ce site utilise des cookies pour am√©liorer votre exp√©rience et mesurer l'audience.
    <button onclick="acceptCookies()">Accepter</button>
  </div>

  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({ pageLanguage: 'fr' }, 'google_translate_element');
    }

    emailjs.init("U08QGWWRUenJDOllc");
    let formEnvoye = false;

    function sendEmail(event) {
      event.preventDefault();
      if (formEnvoye) return alert("Votre demande a d√©j√† √©t√© envoy√©e.");

      const params = {
        nom: nom.value,
        telephone: telephone.value,
        depart: depart.value,
        arrivee: arrivee.value,
        dateheure: dateheure.value,
        passagers: passagers.value,
        message: message.value,
        prix: document.getElementById("prixEstime").innerText
      };

      emailjs.send("service_kdvgh9f", "template_5xt5vlv", params)
        .then(() => {
          formEnvoye = true;
          trackConversion('form_submitted');
          document.querySelector(".form-section").innerHTML = `
            <div style="text-align: center; padding: 40px 20px;">
              <h2 style="color: #28a745; font-size: 28px;">‚úÖ Demande envoy√©e !</h2>
              <p style="margin-top: 10px; font-size: 18px;">Nous vous contacterons rapidement.</p>
              <button onclick="window.location.reload()" style="margin-top: 30px; padding: 12px 24px; background-color: #007bff; border: none; color: white; border-radius: 6px; font-size: 16px; cursor: pointer;">
                Faire une nouvelle demande
              </button>
            </div>`;
        })
        .catch(() => {
          alert("‚ùå Une erreur est survenue. Veuillez r√©essayer.");
        });
    }

    function calculerEstimation() {
      const d = depart.value, a = arrivee.value;
      if (!d || !a) return alert("Veuillez entrer les adresses");
      fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(d)}&format=json&limit=1`)
        .then(res => res.json()).then(data1 => {
          if (!data1.length) throw "Erreur d√©part";
          const start = `${data1[0].lon},${data1[0].lat}`;
          fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(a)}&format=json&limit=1`)
            .then(res => res.json()).then(data2 => {
              if (!data2.length) throw "Erreur arriv√©e";
              const end = `${data2[0].lon},${data2[0].lat}`;
              fetch(`https://router.project-osrm.org/route/v1/driving/${start};${end}?overview=false`)
                .then(res => res.json()).then(route => {
                  const dist = route.routes[0].distance / 1000;
                  let prix = 20 + Math.max(0, dist - 7) * 1.6;
                  prixEstime.innerText = `Distance : ${dist.toFixed(1)} km | Estimation : ${prix.toFixed(2)} ‚Ç¨`;
                });
            });
        })
        .catch(() => {
          prixEstime.innerText = "Estimation impossible.";
        });
    }

    let map = L.map('map').setView([42.7, 2.9], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);
    navigator.geolocation.getCurrentPosition(pos => {
      const latlng = [pos.coords.latitude, pos.coords.longitude];
      L.marker(latlng).addTo(map).bindPopup("Vous √™tes ici").openPopup();
      map.setView(latlng, 13);

      // ‚úÖ Tracking ville avec GA4
      fetch(`https://nominatim.openstreetmap.org/reverse?lat=${latlng[0]}&lon=${latlng[1]}&format=json`)
        .then(res=>res.json())
        .then(data=>{
          if(data.address.city){
            gtag('event','visitor_city',{city:data.address.city});
          }
        });
    });

    function acceptCookies(){
      document.getElementById("cookie-banner").style.display="none";
      gtag('event','cookies_accepted');
    }
  </script>

  <div style="display:none">
    VTC Perpignan, chauffeur priv√© Perpignan, r√©servation VTC 66, taxi Perpignan, Uber Perpignan, Bolt Perpignan, ...
    Perpignan, Saint-Est√®ve, Canet-en-Roussillon, Cabestany, Rivesaltes, Argel√®s-sur-Mer, Barcar√®s, Leucate, Torreilles, Espagne, G√©rone, Figueras, Costa Brava, etc.
  </div>
</body>
</html>
